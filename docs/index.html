<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>応用情報技術者試験 用語集</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  body { font-family: sans-serif; margin: 20px; }

  #filter-area {
    position: sticky;
    top: 0;
    background: #fff;
    padding: 10px 0;
    z-index: 10;
  }

  #terms {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    padding: 0;
    margin: 10px 0;
    margin-bottom: 45vh;
  }

  .category {
    margin-bottom: 20px;
  }
  .category-title {
    font-size: 18px;
    font-weight: bold;
    margin-bottom: 10px;
  }
  .category-terms {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
  }
  .term {
    cursor: pointer;
    color: #007bff;
    padding: 5px 10px;
    border: 1px solid #ccc;
    border-radius: 4px;
    background: #f9f9f9;
    white-space: nowrap;
  }
  .term:hover { text-decoration: underline; }

  #description {
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 40%;
    overflow-y: auto;
    background: #fff;
    border-top: 2px solid #ccc;
    padding: 10px;
    box-sizing: border-box;
  }

  .term-image {
    max-width: 300px;
    height: auto;
    display: block;
    margin-top: 10px;
  }

  .active-term {
    background: #d0e8ff;
    border-color: #66a5ff;
  }

@media (max-width: 768px) {
    .category-terms {
      flex-direction: column;
      gap: 5px;
    }
    .term {
      width: 100%;
      text-align: center;
      font-size: 16px;
      padding: 10px;
    }
    #description {
      height: 50%;
      font-size: 20px;
    }
    .term-image {
      max-width: 100%;
      height: auto;
    }
}
</style>
</head>

<body>

<!-- ▼ 追加：優先度フィルター -->
<div id="filter-area">
  <label>優先度フィルタ：</label>
  <select id="priorityFilter">
    <option value="all">すべて表示</option>
    <option value="1">優先度1のみ</option>
    <option value="2">優先度2のみ</option>
    <option value="3">優先度3のみ</option>
  </select>
</div>

<div id="terms"></div>
<div id="description">ここに説明が表示されます。</div>

<script>
let allData = []; // JSONの保持

fetch('terms.json?v=' + Date.now())
  .then(response => response.json())
  .then(data => {
    allData = data;
    renderTerms(data); // 初回描画
  });

// ▼ フィルタ変更時の処理
document.getElementById('priorityFilter').addEventListener('change', () => {
  const value = document.getElementById('priorityFilter').value;

  if (value === 'all') {
    renderTerms(allData);
  } else {
    const filtered = allData.map(category => ({
      ...category,
      terms: category.terms.filter(t => String(t.priority) === value)
    }));
    renderTerms(filtered);
  }
});

// ▼ 描画関数
function renderTerms(data) {
  const list = document.getElementById('terms');
  const descBox = document.getElementById('description');
  list.innerHTML = ''; // 一度クリア

  data.forEach(category => {
    const categoryDiv = document.createElement('div');
    categoryDiv.className = 'category';

    const title = document.createElement('div');
    title.className = 'category-title';
    title.textContent = category.title;
    categoryDiv.appendChild(title);

    const termsContainer = document.createElement('div');
    termsContainer.className = 'category-terms';

    category.terms.forEach(item => {
      const termDiv = document.createElement('div');
      termDiv.textContent = item.term;
      termDiv.className = 'term';

      termDiv.addEventListener('click', () => {
        const active = document.querySelector('.active-term');
        if (active) active.classList.remove('active-term');
        termDiv.classList.add('active-term');

        descBox.innerHTML = `
          <h2>${item.term}</h2>
          <p>${item.description}</p>
          ${item.image && item.image !== '-' ? `${item.image}` : ''}
        `;
      });

      termsContainer.appendChild(termDiv);
    });

    categoryDiv.appendChild(termsContainer);
    list.appendChild(categoryDiv);
  });
}
</script>

</body>
</html>
